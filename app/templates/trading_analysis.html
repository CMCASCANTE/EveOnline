{% extends 'base_layout.html' %} 

{% block title %}AnÃ¡lisis Trading Puro{% endblock %}

{% block content %}
<div class="container">
    {% if error %}
        <h1 style="color: #ff3333;">âŒ Error al Ejecutar el AnÃ¡lisis de Trading:</h1>
        <p style="color: #ff3333;">{{ error }}</p>
    {% else %}
        <h1>âœ… ANÃLISIS DE TRADING PURO FINALIZADO</h1>
        <p class="time-info">Datos actualizados: {{ data.current_time }}</p>

        <div style="margin-bottom: 20px; text-align: center;">
            <a href="{{ url_for('home') }}">
                <button class="tab-button" style="background-color: #1E90FF;">
                    â¬…ï¸ IR A INICIO
                </button>
            </a>
            <a href="{{ url_for('analyze') }}">
                <button class="tab-button" style="background-color: #4CAF50;">
                    ğŸ’° IR A TIENDA LP
                </button>
            </a>
        </div>


        <div class="tab-button-group">
            <button class="tab-button" onclick="openTab(event, 'global-arbitrage')" id="defaultOpen">ğŸ’° Arbitraje Global (Top Spread)</button>
            <button class="tab-button" onclick="openTab(event, 'global-volume')">ğŸ“ˆ Mayor Volumen Global</button>
            
            {% for market in data.markets %}
                <button class="tab-button" onclick="openTab(event, 'market-{{ market | lower }}')">ğŸ“ {{ market }}</button>
            {% endfor %}
        </div>
        
        <div id="global-arbitrage" class="tab-content">
            <h2>ğŸ’° Arbitraje Global (Mejor Spread por Item - Top {{ data.global_arbitrage|length }})</h2>
            {% set current_results = data.global_arbitrage %}
            {% set table_id = 'table-global-arbitrage' %}
            {% include '_trading_table_template.html' with context %}
        </div>

        <div id="global-volume" class="tab-content">
            <h2>ğŸ“ˆ Mayor Volumen Global (Top Volumen por Item - Top {{ data.global_volume|length }})</h2>
            {% set current_results = data.global_volume %}
            {% set table_id = 'table-global-volume' %}
            {% include '_trading_table_template.html' with context %}
        </div>
        
        {% for market_name, results in data.market_results.items() %}
            <div id="market-{{ market_name | lower }}" class="tab-content">
                <h2>ğŸ“ Trading en {{ market_name }} (Top {{ results|length }})</h2>
                {% set current_results = results %}
                {% set table_id = 'table-market-' + market_name | lower %}
                {% include '_trading_table_template.html' with context %}
            </div>
        {% endfor %}

    {% endif %}

</div>

<script>
    // Abrir la primera pestaÃ±a al cargar la pÃ¡gina
    document.addEventListener("DOMContentLoaded", function() {
        const defaultOpenButton = document.getElementById('defaultOpen');
        if (defaultOpenButton) {
            defaultOpenButton.click();
        }
    });
</script>
{% endblock %}