{% extends 'base_layout.html' %} 

{% block title %}Resultados del An√°lisis{% endblock %}

{% block content %}

<div class="container">
    {% if error %}
        <h1 class="negative">‚ùå Error al Ejecutar el An√°lisis:</h1>
        <p class="negative">{{ error }}</p>
    {% else %}
        <h1>‚úÖ AN√ÅLISIS DE RENTABILIDAD LP FINALIZADO</h1>
        <p class="meta-info">Datos actualizados: {{ data.current_time }}</p>

        <div style="margin-bottom: 20px;">
            <a href="{{ url_for('home') }}">
                <button class="reload-button">
                    ‚¨ÖÔ∏è INICIAR NUEVA B√öSQUEDA
                </button>
            </a>
        </div>
        
        {% set current_results = data.global_max_isk %}
        {% set headers = data.headers %}
        <h2>TABLA 5: TOP {{ data.global_max_isk|length }} RENTABILIDAD M√ÅXIMA GLOBAL</h2>
        {% include 'table_template.html' with context %}
        
        {% set current_results = data.global_liquidez_media %}
        <h2>TABLA 6: TOP {{ data.global_liquidez_media|length }} LIQUIDEZ MEDIA (ISK/LP AVG ‚â• 1,000)</h2>
        {% include 'table_template.html' with context %}

        {% set current_results = data.global_liquidez_alta %}
        <h2>TABLA 7: TOP {{ data.global_liquidez_alta|length }} LIQUIDEZ ALTA (ISK/LP AVG ‚â• 2,000)</h2>
        {% include 'table_template.html' with context %}

        <h1>üìä An√°lisis por Mercado Regional</h1>

        {% for market_name, results in data.market_results.items() %}
            {% set current_results = results %}
            <h2>{{ market_name }} (Top {{ results|length }})</h2>
            {% include 'table_template.html' with context %}
        {% endfor %}

    {% endif %}

    <div style="margin-top: 50px;">
        <a href="{{ url_for('home') }}">
            <button class="reload-button">
                ‚¨ÖÔ∏è INICIAR NUEVA B√öSQUEDA
            </button>
        </a>
    </div>

</div>

{% endblock %}